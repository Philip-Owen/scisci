<div ng-include="'views/partials/nav.html'"></div>
<div ng-include="'views/partials/subnav-module.html'"></div>

<div class="module" ng-if="!vm.isSavedModule.value">
    <h2 class="md-title" ng-if="!vm.isSavedModule.value">Module Creator</h2>

    <form ng-submit="vm.saveModule()" class="creation-header">
        <md-input-container class="module-title-input">
            <label>Module Name</label>
            <input type="text" ng-model="vm.module.data.name" required />
        </md-input-container>
        
        <div class="button-wrapper">
            <input type="submit" class="button" ng-if="!vm.isSavedModule.value" value="Create Module" />
        </div>
    </form>
</div>

<div class="module" ng-if="vm.isSavedModule.value">
    <h2 class="md-title md-title-left" ng-if="vm.isSavedModule.value">Module Editor</h2>

    <form ng-submit="vm.saveModule()">
    <md-input-container class="module-title-input">
        <label>Name</label>
        <input type="text" ng-model="vm.module.data.name" required />
    </md-input-container>

    <input type="submit" class="button" value="Save Module" />

    <ul class="col col-5 quick-report-list">
        <li class="quick-report-list-item"><p class="quick-report-title">Material Cost:</p> <p class="quick-report-value">{{vm.calculations.data.currentSum | currency}}</p></li>
        <li class="quick-report-list-item"><p class="quick-report-title">Material in Kit Cost:</p> <p class="quick-report-value">{{vm.calculations.data.currentKitSum | currency}}</p></li>
        <li class="quick-report-list-item"><p class="quick-report-title">Estimated Labor Cost:</p> <p class="quick-report-value">{{vm.calculations.data.laborCost | currency}}</p></li>
        <li class="quick-report-list-item"><p class="quick-report-title">Materials Ordered + Labor:</p> <p class="quick-report-value">{{vm.calculations.data.current_and_labor_sum | currency}}</p></li>
        <li class="quick-report-list-item"><p class="quick-report-title">Materials in Kit + Labor:</p> <p class="quick-report-value">{{vm.calculations.data.kit_and_labor_sum | currency}}</p></li>
    </ul>
    <md-input-container>
        <label>Code</label>
        <input type="text" ng-model="vm.module.data.code" />
    </md-input-container>

    <md-input-container>
        <label>Estimated Assembly Time (hrs.)</label>
        <input type="text" ng-model="vm.module.data.estimated_assembly_time" />
    </md-input-container>

    <h3 class="md-subtitle">Version</h3>
    <md-input-container>
        <label>Version Number</label>
        <input type="text" ng-model="vm.module.data.version_number" />
    </md-input-container>

    <md-input-container>
        <label>Version Notes</label>
        <textarea ng-model="vm.module.data.version_notes"></textarea>
    </md-input-container>

    <md-datepicker ng-model="vm.module.data.version_date"></md-datepicker>

    <!-- <input type="text" placeholder="Live-search Components" /> -->


    <h2 class="md-title md-title-left">Resources</h2>
    <div class="resource-list col col-5">
        <md-input-container>
            <label>Google Drive (url)</label>
            <input type="text" ng-model="vm.module.data.module_drive_link" />
        </md-input-container>

        <md-input-container>
            <label>To Be Printed (url)</label>
            <input type="text" ng-model="vm.module.data.to_be_printed_link" />
        </md-input-container>

        <md-input-container>
            <label>Assembly Video (url)</label>
            <input type="text" ng-model="vm.module.data.assembly_video_link" />
        </md-input-container>

        <md-input-container>
            <label>Activity Video (url)</label>
            <input type="text" ng-model="vm.module.data.activity_video_link" />
        </md-input-container>

        <md-input-container>
            <label>Kit Content Sheet (url)</label>
            <input type="text" ng-model="vm.module.data.kit_content_link" />
        </md-input-container>

        <md-input-container>
            <label>Custom Link 1 (url)</label>
            <input type="text" ng-model="vm.module.data.other1_link" />
        </md-input-container>

        <md-input-container>
            <label>Custom Link 1 (title)</label>
            <input type="text" ng-model="vm.module.data.other1_title" />
        </md-input-container>

        <md-input-container>
            <label>Custom Link 2 (url)</label>
            <input type="text" ng-model="vm.module.data.other2_link" />
        </md-input-container>

        <md-input-container>
            <label>Custom Link 2 (title)</label>
            <input type="text" ng-model="vm.module.data.other2_title" />
        </md-input-container>
    </div>


    <h2 class="md-title md-title-left">Assembly Instructions</h2>

    <md-input-container>
        <label>Assembly Notes</label>
        <textarea ng-model="vm.module.data.assembly_notes"></textarea>
    </md-input-container>

    <h2 class="md-title md-title-left">Components in Module</h2>

    <md-input-container>
        <label>Filter Components</label>
        <input ng-model="filterString.name" />
      </md-input-container>
      <md-checkbox ng-model="vm.showAllComponents" >Show All Components</md-checkbox> 
    
    <div ng-show="filterString.name.length > 0 || vm.showAllComponents">
      <!-- Table mock up for the time being, will be changed out later for accordion divs  -->
       <div class="mock-table" role="table" aria-label="Components">
          <div class="mock-table-header" role="rowgroup">
              <div class="mock-table-row mock-table-row-header col col-4" row="row">
                <h3 class="columnheader">Add</h3>
                <h3 class="columnheader">Name 
                    <span class="sort-button" ng-click="vm.sortColumns('nameAsc')">
                        <i class="fas fa-caret-square-up"></i>
                    </span>
                
                    <span class="sort-button" ng-click="vm.sortColumns('nameDesc')">
                        <i class="fas fa-caret-square-down"></i>
                    </span>
                </h3>
                <h3 class="columnheader">Type 
                    <span class="sort-button" ng-click="vm.sortColumns('typeAsc')">
                        <i class="fas fa-caret-square-up"></i>
                    </span>
                
                    <span class="sort-button" ng-click="vm.sortColumns('typeDesc')">
                        <i class="fas fa-caret-square-down"></i>
                    </span>
                </h3>
                <h3 class="columnheader">Description</h3>
                <!-- <h3 class="columnheader">Price Per Unit 
                    <span class="sort-button" ng-click="vm.sortColumns('pricePUAsc')">
                        <i class="fas fa-caret-square-up"></i>
                    </span>
                
                    <span class="sort-button" ng-click="vm.sortColumns('pricePUDesc')">
                        <i class="fas fa-caret-square-down"></i>
                    </span>
                </h3>
                <h3 class="columnheader">Pieces Per Unit</h3>
                <h3 class="columnheader">General Stock 
                    <span class="sort-button" ng-click="vm.sortColumns('genStockAsc')">
                        <i class="fas fa-caret-square-up"></i>
                    </span>
                
                    <span class="sort-button" ng-click="vm.sortColumns('genStockDesc')">
                        <i class="fas fa-caret-square-down"></i>
                    </span>
                </h3>
                <h3 class="columnheader">Consumable 
                    <span class="sort-button" ng-click="vm.sortColumns('consumableAsc')">
                        <i class="fas fa-caret-square-up"></i>
                    </span>
                
                    <span class="sort-button" ng-click="vm.sortColumns('consumableDesc')">
                        <i class="fas fa-caret-square-down"></i>
                    </span>
                </h3>
                <h3 class="columnheader">Modules Used In</h3>
                <h3 class="columnheader">Vendor 1 Name 
                    <span class="sort-button" ng-click="vm.sortColumns('vendor1Asc')">   
                        <i class="fas fa-caret-square-up"></i>
                    </span>
                    
                    <span class="sort-button" ng-click="vm.sortColumns('vendor1Desc')">
                        <i class="fas fa-caret-square-down"></i>
                    </span>
                </h3>
                <h3 class="columnheader">Vendor 1 Link</h3>
                <h3 class="columnheader">Vendor 2 Name 
                    <span class="sort-button" ng-click="vm.sortColumns('vendor2Asc')">
                        <i class="fas fa-caret-square-up"></i>
                    </span>
                
                <span class="sort-button" ng-click="vm.sortColumns('vendor2Desc')">
                    <i class="fas fa-caret-square-down"></i>
                </span>
            </h3>
                <h3 class="columnheader">Vendor 2 Link</h3>
                <h3 class="columnheader">Notes</h3> -->
              </div><!-- /.mock-table-row -->
          </div> <!-- /.mock-table-header -->
          <div class="mock-table-body" role="rowgroup">
              <div class="mock-table-row col col-6" row="row" ng-repeat="component in vm.componentLibrary.list | filter:filterString ">
                <p role="cell" ng-if="!vm.edit[component.id]">
                    <md-button class="button" ng-click="vm.addModuleComponentToDraft(component.id, 1, component)">Add</md-button></p>
                <p role="cell" ng-if="vm.edit[component.id]"><input type="text" ng-value="component.name" ng-model="component.name"></p>
    
                <p role="cell" ng-if="!vm.edit[component.id]">{{component.name}}</p>
                <p role="cell" ng-if="vm.edit[component.id]"><input type="text" ng-value="component.name" ng-model="component.name"></p>

                <p role="cell" ng-if="!vm.edit[component.id]">{{component.type}}</p>
                <p role="cell" ng-if="vm.edit[component.id]"><input type="text" ng-value="component.type" ng-model="component.type"></p>
    
                <p role="cell" ng-if="!vm.edit[component.id]">{{component.description}}</p>
                <p role="cell" ng-if="vm.edit[component.id]"><input type="text" ng-value="component.description" ng-model="component.description"></p>
<!--     
                <p role="cell" ng-if="!vm.edit[component.id]">{{component.price_per_unit}}</p>
                <p role="cell" ng-if="vm.edit[component.id]"><input type="text" ng-value="component.price_per_unit" ng-model="component.price_per_unit"></p>
     -->
                <!-- <p role="cell" ng-if="!vm.edit[component.id]">{{component.pieces_per_unit}}</p>
                <p role="cell" ng-if="vm.edit[component.id]"><input type="text" ng-value="component.pieces_per_unit" ng-model="component.pieces_per_unit"></p> -->
    
                <!-- <p role="cell" ng-if="!vm.edit[component.id]">{{component.general_stock_item}}</p> -->
                <!-- <p role="cell" ng-if="vm.edit[component.id]">
                  <select ng-model="component.general_stock_item">
                    <option ng-value="true">True</option>
                    <option ng-value="false">False</option>
                  </select>
                </p>
     -->
                <!-- <p role="cell" ng-if="!vm.edit[component.id]">{{component.consumable}}</p>
                <p role="cell" ng-if="vm.edit[component.id]">
                  <select ng-model="component.consumable">
                    <option ng-value="Yes">Yes</option>
                    <option ng-value="No">No</option>
                  </select>
                </p> -->
    
                <!-- <p role="cell"><span ng-click="vm.getModules(component)">{{component.modules_used_in}}</span></p>
    
                <p role="cell" ng-if="!vm.edit[component.id]">{{component.vendor_name_primary}}</p>
                <p role="cell" ng-if="vm.edit[component.id]"><input type="text" ng-value="component.vendor_name_primary" ng-model="component.vendor_name_primary"></p>
    
                <p role="cell" ng-if="!vm.edit[component.id]">{{component.vendor_url_primary}}</p>
                <p role="cell" ng-if="vm.edit[component.id]"><input type="text" ng-value="component.vendor_url_primary" ng-model="component.vendor_url_primary"></p>
    
                <p role="cell" ng-if="!vm.edit[component.id]">{{component.vendor_name_secondary}}</p>
                <p role="cell" ng-if="vm.edit[component.id]"><input type="text" ng-value="component.vendor_name_secondary" ng-model="component.vendor_name_secondary"></p>
    
                <p role="cell" ng-if="!vm.edit[component.id]">{{component.vendor_url_secondary}}</p>
                <p role="cell" ng-if="vm.edit[component.id]"><input type="text" ng-value="component.vendor_url_secondary" ng-model="component.vendor_url_secondary"></p> -->
    
                <!-- <p role="cell" ng-if="!vm.edit[component.id]">{{component.notes}}</p>
                <p role="cell" ng-if="vm.edit[component.id]"><input type="text" ng-value="component.notes" ng-model="component.notes"></p> -->
    
            </div>
          </div>
      </div>
    
    </div>
<!-- 
    <md-input-container>
        <label>Component ID</label>
        <input type="text" ng-model="vm.newComponentId" />
    </md-input-container>

    <md-input-container>
        <label>Component Quantity</label>
        <input type="number" ng-model="vm.newComponentQuantity" />
    </md-input-container> -->

    <!-- <button ng-click="vm.addModuleComponent(vm.newComponentId, vm.newComponentQuantity)">Add Component</button> -->
    <!-- <button class="button" ng-click="vm.addModuleComponentToDraft(vm.newComponentId, vm.newComponentQuantity)">Add Component Draft</button> -->

    <div class="mock-table" role="table" aria-label="Components">
        <div class="mock-table-header" role="rowgroup">
        <div class="mock-table-row mock-table-row-header col col-8" row="row">
            <h3 class="columnheader">Pieces Per Kit</h3>
            <h3 class="columnheader">Name</h3>
            <h3 class="columnheader">Type</h3>
            <h3 class="columnheader">Description</h3>
            <h3 class="columnheader">Price Per Unit</h3>
            <h3 class="columnheader">Pieces Per Unit</h3>
            <!-- <h3 class="columnheader">Cost Per Unit</h3> -->
            <h3 class="columnheader">Delete</h3>
			<h3 class="columnheader">More Info</h3>
        </div><!-- /.mock-table-row-header -->
    </div><!-- /.mock-table-header -->

        <div ng-repeat="row in vm.components.data" class="mock-table-body" role="rowgroup">
            <div class="mock-table-row col col-8" row="row">
            <p role="cell">

                <md-input-container>
                    <!-- <label>#</label> -->
                    <input min="1" required type="number" ng-model="row.pieces_per_kit" />
                </md-input-container>
            </p>
            <p role="cell">{{row.name}}</p>
            <p role="cell">{{row.type}}</p>
            <p role="cell">{{row.description}}</p>
            <p role="cell">{{row.price_per_unit}}</p>
            <p role="cell">{{row.pieces_per_unit}}</p>
            <!-- <p role="cell">{{row.cost_per_unit}}</p> -->
            <p role="cell">
                <button class="button-naked" ng-click="vm.deleteModuleComponentInDraft(row.module_id, row.component_id)">
                    <i class="fas fa-trash-alt"></i>
                </button>
            </p>
            <p role="cell" ng-click="vm.showHideTableData[$index].show = !vm.showHideTableData[$index].show">
                <span class="sort-button">
                    <i class="fas fa-info-circle"></i>
                </span>
            </p>

				<div class="collapsed-table-data" ng-if="vm.showHideTableData[$index].show">
					<div class="mock-table" role="table" aria-label="Components">
						<div class="mock-table-header" role="rowgroup">
							<div class="mock-table-row mock-table-row-header" row="row">
                                <!-- <h3 class="columnheader">Modules Used In</h3> -->
                                <h3 class="columnheader">General Stock</h3>
                                <h3 class="columnheader">Consumable</h3>
                                <h3 class="columnheader">Vendor Name 1</h3>
                                <h3 class="columnheader">Vendor Link 1</h3>
                                <h3 class="columnheader">Vendor Name 2</h3>
                                <h3 class="columnheader">Vendor Link 2</h3>
                                <h3 class="columnheader">Purpose/Notes</h3>
                            </div>
                        </div>

						<div class="mock-table-body" role="rowgroup">
                            <div class="mock-table-row" row="row">
                                <!-- <p role="cell">{{row.modules_used_in}}</p> -->
                                <p role="cell">{{row.general_stock_item}}</p>
                                <p role="cell">{{row.consumable}}</p>
                                <p role="cell">{{row.vendor_name_primary}}</p>
                                <p role="cell">{{row.vendor_url_primary}}</p>
                                <p role="cell">{{row.vendor_name_secondary}}</p>
                                <p role="cell">{{row.vendor_url_secondary}}</p>
                                <p role="cell">{{row.notes}}</p>
                            </div>
                        </div>
                    </div>
                </div>

            </div><!-- /.mock-table-row -->
        </div><!-- /.mock-table-body -->
    </div><!-- /.mock-table-header -->

    </form>

</div><!-- /.module -->
